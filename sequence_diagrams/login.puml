@startuml

title Sequence Diagram for Viewing Garage Status

actor GarageManager
boundary MyGarageListUI
control AuthMiddleware
control GarageController
participant GarageService
participant Database as "DB"

== User Requests Garage List ==
GarageManager -> MyGarageListUI: (1) Click "My Garage List"
activate MyGarageListUI
MyGarageListUI -> AuthMiddleware: (2) Attach Authorization Token
activate AuthMiddleware
AuthMiddleware -> AuthMiddleware: (3) Validate Token & Roles
alt Invalid Token or Unauthorized
    AuthMiddleware --> GarageManager: (4) Return error "Access Denied"
    deactivate AuthMiddleware
else Valid Token
    AuthMiddleware -> GarageController: (4) Forward request with user data
    deactivate AuthMiddleware
end

== Fetching Garage List ==
GarageController -> GarageService: (5) Retrieve garages for user
activate GarageService
GarageService -> Database: (6) Query garages by user ID
activate Database
Database --> GarageService: (7) Return list of garages
    deactivate Database
GarageService --> GarageController: (8) Return garage list with name & status
    deactivate GarageService
GarageController --> MyGarageListUI: (9) Send garage list
    deactivate GarageController
MyGarageListUI --> GarageManager: (10) Display garage list with name & status
    deactivate MyGarageListUI

@enduml
